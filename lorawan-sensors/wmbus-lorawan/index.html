



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Online documentation of the Lobaro GmbH, Industrial IoT Solutions. Manuals for our IoT Devices.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.0">
    
    
      
        <title>Manual - Lobaro Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Cousine&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Cousine","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/lobarodoc.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-69919312-3", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="white" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#wireless-mbus-over-lorawan-bridge" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="Lobaro Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../img/lobaro-rings-circle.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Lobaro Documentation
            </span>
            <span class="md-header-nav__topic">
              
                Manual
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/lobaro/docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="Lobaro Documentation" class="md-nav__button md-logo">
      
        <img src="../../img/lobaro-rings-circle.svg" width="48" height="48">
      
    </a>
    Lobaro Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/lobaro/docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../hardware.html" title="Hardware Variations" class="md-nav__link">
      Hardware Variations
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      LoRaWAN Sensors
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        LoRaWAN Sensors
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1" checked>
    
    <label class="md-nav__link" for="nav-3-1">
      wMBUS Bridge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        wMBUS Bridge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Manual
      </label>
    
    <a href="index.html" title="Manual" class="md-nav__link md-nav__link--active">
      Manual
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-device" class="md-nav__link">
    The Device
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variant-with-compact-housing-2xaa-batteries" class="md-nav__link">
    Variant with compact housing (2xAA batteries)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variant-with-d-cell-battery" class="md-nav__link">
    Variant with D-cell battery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-installation" class="md-nav__link">
    Device installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#power-supply" class="md-nav__link">
    Power Supply
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battery-life-time" class="md-nav__link">
    Battery life time
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-calculation" class="md-nav__link">
    Example calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-scenario-recommendations" class="md-nav__link">
    Usage scenario recommendations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#work-cycle" class="md-nav__link">
    Work Cycle
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-phase" class="md-nav__link">
    Initial Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lorawan-join-phase" class="md-nav__link">
    LoRaWAN Join Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-collection-phase" class="md-nav__link">
    Data Collection Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-transfer-phase" class="md-nav__link">
    Data Transfer Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sleep-phase" class="md-nav__link">
    Sleep Phase
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-lobaro-maintenance-tool" class="md-nav__link">
    The Lobaro Maintenance Tool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-the-usb-config-adapter" class="md-nav__link">
    Connecting the USB config adapter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-parameters" class="md-nav__link">
    System parameters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lorawan-network-parameters" class="md-nav__link">
    LoRaWAN network parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wmbus-bridge-parameters" class="md-nav__link">
    wMBUS bridge parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cron-expressions" class="md-nav__link">
    Cron expressions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lorawan-data-upload-formats" class="md-nav__link">
    LoRaWAN Data Upload Formats
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#status-packet" class="md-nav__link">
    Status Packet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-packet" class="md-nav__link">
    Data Packet
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-rate" class="md-nav__link">
    Upload Rate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decoding-wireless-m-bus" class="md-nav__link">
    Decoding wireless M-Bus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-characteristics" class="md-nav__link">
    Technical characteristics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#housing-dimensions" class="md-nav__link">
    Housing Dimensions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#target-measurement-purpose" class="md-nav__link">
    Target Measurement / Purpose
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pdf-documentation" class="md-nav__link">
    PDF Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parser" class="md-nav__link">
    Parser
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ttn" class="md-nav__link">
    TTN
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Modbus Bridge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Modbus Bridge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../modbus-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modbus-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../modbus-lorawan/versions.html" title="Versions" class="md-nav__link">
      Versions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      EDL21 Bridge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        EDL21 Bridge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../edl21-opto-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../edl21-opto-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      1-Wire Bridge
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        1-Wire Bridge
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../1-wire-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../1-wire-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      GPS Tracker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        GPS Tracker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../gps-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gps-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Usonic Distance Sensor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Usonic Distance Sensor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../usonic-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../usonic-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Temp. + rH. Sensor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        Temp. + rH. Sensor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../humidity-temp-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../humidity-temp-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Pressure Sensor
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        Pressure Sensor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pressure-lorawan/index.html" title="Manual" class="md-nav__link">
      Manual
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pressure-lorawan/firmware.html" title="Firmware & Changelog" class="md-nav__link">
      Firmware & Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../dashboard/index.html" title="Lobaro Dashboard" class="md-nav__link">
      Lobaro Dashboard
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Lobaro Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Lobaro Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/lobaro-tool.html" title="Lobaro Maintenance Tool" class="md-nav__link">
      Lobaro Maintenance Tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/usb-config-adapter.html" title="USB Config Adapter" class="md-nav__link">
      USB Config Adapter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Knowledge base
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Knowledge base
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../background/cron-expressions.html" title="CRON Expressions" class="md-nav__link">
      CRON Expressions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../background/lorawan.html" title="LoRaWAN" class="md-nav__link">
      LoRaWAN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../background/obis-codes.html" title="OBIS Codes" class="md-nav__link">
      OBIS Codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../background/weee-disposal.html" title="WEEE Disposal" class="md-nav__link">
      WEEE Disposal
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://www.lobaro-shop.com/" title="Online Shop" class="md-nav__link">
      Online Shop
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://www.lobaro.com/" title="Company Home (DE)" class="md-nav__link">
      Company Home (DE)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="https://www.lobaro.com/contact/" title="Contact / Impressum" class="md-nav__link">
      Contact / Impressum
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-device" class="md-nav__link">
    The Device
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variant-with-compact-housing-2xaa-batteries" class="md-nav__link">
    Variant with compact housing (2xAA batteries)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variant-with-d-cell-battery" class="md-nav__link">
    Variant with D-cell battery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#device-installation" class="md-nav__link">
    Device installation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#power-supply" class="md-nav__link">
    Power Supply
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#battery-life-time" class="md-nav__link">
    Battery life time
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-calculation" class="md-nav__link">
    Example calculation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-scenario-recommendations" class="md-nav__link">
    Usage scenario recommendations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#work-cycle" class="md-nav__link">
    Work Cycle
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-phase" class="md-nav__link">
    Initial Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lorawan-join-phase" class="md-nav__link">
    LoRaWAN Join Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-collection-phase" class="md-nav__link">
    Data Collection Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-transfer-phase" class="md-nav__link">
    Data Transfer Phase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sleep-phase" class="md-nav__link">
    Sleep Phase
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-lobaro-maintenance-tool" class="md-nav__link">
    The Lobaro Maintenance Tool
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-the-usb-config-adapter" class="md-nav__link">
    Connecting the USB config adapter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-parameters" class="md-nav__link">
    System parameters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lorawan-network-parameters" class="md-nav__link">
    LoRaWAN network parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wmbus-bridge-parameters" class="md-nav__link">
    wMBUS bridge parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cron-expressions" class="md-nav__link">
    Cron expressions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lorawan-data-upload-formats" class="md-nav__link">
    LoRaWAN Data Upload Formats
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#status-packet" class="md-nav__link">
    Status Packet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-packet" class="md-nav__link">
    Data Packet
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-rate" class="md-nav__link">
    Upload Rate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decoding-wireless-m-bus" class="md-nav__link">
    Decoding wireless M-Bus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-characteristics" class="md-nav__link">
    Technical characteristics
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#housing-dimensions" class="md-nav__link">
    Housing Dimensions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#target-measurement-purpose" class="md-nav__link">
    Target Measurement / Purpose
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pdf-documentation" class="md-nav__link">
    PDF Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parser" class="md-nav__link">
    Parser
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ttn" class="md-nav__link">
    TTN
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/lobaro/docs/edit/master/docs/lorawan-sensors/wmbus-lorawan/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="wireless-mbus-over-lorawan-bridge">Wireless mBUS over LoRaWAN Bridge</h1>
<div class="admonition note">
<p class="admonition-title">Scope of this manual</p>
<p>This manual is currently only valid for the stable firmware version <strong>V1.6.0</strong>!</p>
<p>It will be soon updated to reflect the new V2.3.x firmware branch with these additional new features:</p>
<ul>
<li>Optional LoRaWAN v1.1 support </li>
<li>LoRaWAN time synchronisation</li>
<li>LoRaWAN Downlink configuration</li>
<li>wMBUS learning mode for meter tx intervals</li>
<li>LoRaWAN Class C support</li>
<li>Optional alternative payload format with better LoRaWAN SF adoption</li>
</ul>
<p>You can try these new features today by using the experimental firmware available <a href="firmware.html" target="_blank"><strong>on this page</strong></a>.</p>
</div>
<h2 id="overview">Overview</h2>
<p>The Lobaro wireless M-Bus (wMBUS) to LoRaWAN Bridge is a cost-effective &amp; energye
efficient device that receives, caches and transparently forwards wireless M-Bus metering
data from up to 500 consumption meters via any LoRaWAN network onto the Internet.<br />
Many gas, water, electricity and heat meters can be read wirelessly today using the common
short range Wireless M-Bus standard. Because such wMBUS enabled meters use the classical
energy saving FSK radio modulation, the wireless range is often limited to less than 50m
and therefore requires the use of additional longer-range radio technologies to forward the
metering data onto the Internet. The advanced LoRa radio modulation used inside the Lobaro
wMBUS to LoRaWAN Bridge is such a key technology.</p>
<p><img alt="Lobaro wmbus LoRaWAN Bridge" src="files/Übersicht-wmbus-lora.jpg" style="width:100%" /></p>
<p>LoRaWAN based LPWANs (Low Power wide area networks) allow connections to the Internet
from small battery powered devices with wireless ranges of up to 5 kilometers between
the transmitter and receiving gateway antenna - without the usual cellular network costs in
classical M2M or smart metering solutions. Also - unlike with cellular networks - it's possible
to setup own gateways if needed. This often results in much lower operational costs with the
Lobaro wMBUS bridge compared to conventional remote meter reading via LTE networks.
The metering data will not be decrypted by the LoRaWAN Bridge, instead an unchanged
1:1 forwarding takes place via one or more LoRaWAN packets (depending on the wMBUS
telegram byte size). Thus the end-to-end encryption of sensitive wireless MBUS consumption
data is preserved.
Initial configuration, firmware updates &amp; status readouts are done user-friendly via USB on the
PC with the Lobaro Tool (Windows, Linux, Mac). An additional possibility of configuration in the field "over the air" by means of LoRaWAN downlinks will soon also be available via
firmware update.</p>
<p><strong>Please read the manual carefully before operating the device. A safe operation of the
device is only possible if you follow the guides provided in this manual. Using the device
differently than intended by Lobaro may cause damage to people, the environment, or
the device.</strong></p>
<div class="admonition info">
<p class="admonition-title">Consider using the latest firmware on your hardware</p>
<ul>
<li><a href="firmware.html" target="_blank"><strong>See available firmware downloads</strong></a></li>
</ul>
</div>
<h2 id="the-device">The Device</h2>
<h3 id="variant-with-compact-housing-2xaa-batteries">Variant with compact housing (2xAA batteries)</h3>
<p><code>wMBUS LoRaWAN Bridge (AA-cells, compact IP65 housing), Order number: 8000003</code> <br>
<img alt="Modbus LoRaWAN Bridge" src="files/wmbusbridge.png" style="width:60%; display: block; margin: 0 auto;" /></p>
<h3 id="variant-with-d-cell-battery">Variant with D-cell battery</h3>
<p><code>wMBUS LoRaWAN Bridge (XH battery-connector, IP67 housing), Order number: 8000063</code> <br>
<img alt="Modbus LoRaWAN Bridge" src="files/wmbusbridgePOWERADDON.png" style="width:50%; display: block; margin: 0 auto;" /></p>
<hr />
<div class="admonition note">
<p class="admonition-title">Further customization Options</p>
<p>The product variants shown above are the <em>standard</em> variants.</p>
<p><a href="../../hardware.html" target="_blank"><strong>Other power supply options &amp; housing are available on request</strong></a></p>
<ul>
<li>External antenna</li>
<li>External power supply</li>
<li>DIN-Rail mounting</li>
<li>NB-IoT instead of LoRaWAN</li>
</ul>
<p>Contact us via <a href="mailto:support@lobaro.de">support@lobaro.de</a> if you need our offer for a special variant.</p>
</div>
<h3 id="device-installation">Device installation</h3>
<p>The device must be fixed on a flat surface using the lateral mounting holes of the case, see
chapter "Housing Dimensions" for a detailed description of all housing dimensions. Alternatively we offer as
accessory a mounting clip for a standard 35mm DIN rail. The device can then easily snapped
on a such rails. It can therefore be added to a variety of racks alongside other devices.</p>
<div class="admonition warning">
<p class="admonition-title">Under any circumstances the device must not be mounted higher than 2 meters above ground to avoid any risks in case of falling down!</p>
</div>
<p>For optimal RF performance (e.g. LoRa range) any metal obstacles near the internal antenna
should be avoided. In this case 'near' is defined as keep-out distance of about 3-5 centimeters
around the antenna. The internal helix antenna can be identified by the winding pcb traces
near the white printed encircled 'connectivity' symbol. In any case a device mounting directly
on top of a metal surface is not advisable since it will degrade the possible RF range. Stone
walls, wood or plastic standos are perfectly ok.
In case of challenging installation locations (e.g. in basements) or unavoidable long distances
to the next LoRaWAN gateway, Lobaro offers on request custom product variant equipped
with a 'SMA' connector to support a external antenna connection.</p>
<h3 id="power-supply">Power Supply</h3>
<p>The wMBUS over LoRaWAN Bridge default power supply consists of two series connected
off-the-shelf 1.5V 'AA' sized batteries. Be sure to get the polarity right, see the '+'-Symbol on
the board. In general only AA cells of the types Alkali-Manganese (1.5V, LR6) and Lithium-
Iron-Sulphide (1.5V, FR6) are allowed to be inserted in the device. Lobaro recommends the
use of FR6 batteries like the Energizer Ultimate Lithium over LR6 types because of the higher
capacity and better discharge properties.</p>
<div class="admonition warning">
<p class="admonition-title">Other Batteries or accumulators with a nominal voltage of more than 1.5V must not inserted into the device under any circumstances. In particular, lithium based cells with a nominal voltage of 3.6V or 3.7V must not be used on the AA battery slots!</p>
</div>
<p>On request we can supply custom product variants with special housings powered by even
bigger batteries. For example a 3.6V C sized mono cell typically has a capacity of 9Ah with
leads to a 3x increased battery life compared to the standard AA-cells. With D sized cells of
typically 19Ah capacity this value can be doubled once again (6x). Also available on request
are options with permanent external power supply (230V, 9-24V, 5V USB).</p>
<h3 id="battery-life-time">Battery life time</h3>
<p>The battery life time of the wireless M-Bus to LoRaWAN Bridge can not be specifed trustworthy
without knowledge of the detailed installation scenario. At least estimations for the
following custom project based parameters have to be known:</p>
<ul>
<li>
<p>Meter count per single wMBUS bridge, e.g. 10 different meters.</p>
</li>
<li>
<p>Needed LoRaWAN transmission interval, e.g. daily uploads.</p>
</li>
<li>
<p>Average wireless M-Bus telegram size in bytes, e.g. 35 byte.</p>
</li>
<li>
<p>Wireless M-Bus telegram transmission interval of the meter, e.g. every 10 seconds.</p>
</li>
<li>
<p>Typically used LoRa Spreading Factor / LoRa link quality, e.g. SF10.</p>
</li>
</ul>
<p>Depending on these parameters battery life times from a few months to over 15 years can
be achieved. You may send us your use-case details as described above to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;">&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;</a>
and we will return to you a custom battery lifetime calculation, a recommendation for the
best power supply scheme and the needed minimal battery capacity.</p>
<h4 id="example-calculation">Example calculation</h4>
<p>In this battery lifetime calculation scenario the target meters send a 35 byte long ('L-Field')
wireless M-Bus telegram constantly every 10 seconds. This behavior is for example very
similar to a 'Hydrus' ultrasonic water meter of <a href="https://www.diehl.com/metering/" target="_blank"><strong>Diehl Metering</strong></a>. The Diehl meter itself has a
specified battery life time of 12 years.
Because of the mentioned 10 second send interval it is sufficient to configure the bridge for
a wireless M-Bus listen period of 20 seconds by setting the bridge configuration parameter
cmodeDurSec to a value of 20 (refer to section "wMBUS bridge parameters"). This will ensure that all meters of
interest sent their consumption telegrams at least onces during the configured listen period
of the bridge.
For a worst-case battery-lifetime calculation the weakest possible LoRaWAN connectivity has
been selected. That means to reach a LoRaWAN Gateway the Lobaro hardware has to send
out its Uplink data very slowly (&ge; 2 seconds) and redundant by using a LoRa spreading factor
of 12. Beside this the actual usable battery capacity has been set to 80% of the nominal
value. The resulting worst-case minimal battery-life times are presented below.</p>
<p><strong>Battery life for daily LoRaWAN uploads with SF12</strong></p>
<table>
<thead>
<tr>
<th>Collected meters</th>
<th>Battery Life (years) AA cell (3Ah)</th>
<th>Battery Life (years) Baby cell(9Ah)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10.7</td>
<td>32.0</td>
</tr>
<tr>
<td>5</td>
<td>7.0</td>
<td>21.1</td>
</tr>
<tr>
<td>10</td>
<td>4.9</td>
<td>14.8</td>
</tr>
<tr>
<td>20</td>
<td>3.1</td>
<td>9.3</td>
</tr>
<tr>
<td>40</td>
<td>1.8</td>
<td>5.3</td>
</tr>
<tr>
<td>80</td>
<td>1.0</td>
<td>2.9</td>
</tr>
</tbody>
</table>
<p>Estimations for the opposite situation with a excellent LoRa link quality and thus the possible
usage of SF7 are presented below.
In real world installations the possible spreading factor may be optimized anytime by setting
up additional LoRaWAN Gateways near the meters of interest.</p>
<p><strong>Battery life for daily LoRaWAN uploads with SF7</strong></p>
<table>
<thead>
<tr>
<th>Collected meters</th>
<th>Battery Life (years) AA cell (3Ah)</th>
<th>Battery Life (years) Baby cell(9Ah)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>12.1</td>
<td>36.4</td>
</tr>
<tr>
<td>5</td>
<td>11.8</td>
<td>35.4</td>
</tr>
<tr>
<td>10</td>
<td>11.4</td>
<td>34.4</td>
</tr>
<tr>
<td>20</td>
<td>10.6</td>
<td>31.9</td>
</tr>
<tr>
<td>40</td>
<td>9.4</td>
<td>28.3</td>
</tr>
<tr>
<td>80</td>
<td>7.7</td>
<td>23.0</td>
</tr>
</tbody>
</table>
<h4 id="usage-scenario-recommendations">Usage scenario recommendations</h4>
<p>As a simple rule of thumb using the Lobaro wireless M-Bus over LoRaWAN bridge is a good
fit in applications that require daily (or less often) consumption values of 1 to 40 installed
wireless M-Bus meters. For installations with a higher meter count simply more Lobaro
bridges may be used.
Another key factor for high battery lifetime is to select or configure your wireless M-Bus
meters in a way that they send short telegrams very frequently, proven good values are
periods smaller than 30 seconds and telegram sizes smaller 50 bytes. This helps to minimize
the needed wMBus listening time period and avoids the need for multiple LoRaWAN packets
per single telegram (data splitting). Beside this the bridge is naturally most economical when multiple meters per single bridge
can be collected and forwarded via LoRWAN. Although for some applications a 1:1 setup,
e.g. one bridge per meter, may deliver enough benefits to justify the invest.
For hourly or even more frequent meter data uploads, as requested by some of our customers,
LoRaWAN isn't the perfect match from a technology point of view. The same holds
for scenarios where hundreds of meters are expected to be transfered by a single bridge,
e.g. in 'sub-metering' applications with tons of installed heat cost allocators. For such more
demanding cases Lobaro can offer better solutions using higher bandwidth transmission techniques
like NB-IoT (Narrowband IoT) or classical 4G/LTE. Contact us if you need such a alternative solution
by sending your request to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;">&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;</a> - either English or German is fine.</p>
<h2 id="work-cycle">Work Cycle</h2>
<p><div class="mermaid">graph LR;
    wmbus(wMBUS Collection)
    init(Initial)==&gt;check(LoRaWAN Join);
    check(LoRaWAN Join)==&gt;wmbus(wMBUS Collection);
    wmbus(wMBUS Collection)==&gt;trans(LoRaWAN Transfer);
    trans(LoRaWAN Transfer)==&gt;sleep(Sleep);
    sleep(Sleep)==&gt;|Cron expression|wmbus(wMBUS Collection)</div>
The Bridge has a simple work cycle that consists of five phases.</p>
<h3 id="initial-phase">Initial Phase</h3>
<p>This is the phase that is executed after the device is started of restarted. The Bridge performs
a quick self test which you can easily spot by the green internal LED flashing. After that,
the configuration is evaluated. If successful, the LoRaWAN Join phase is executed next.</p>
<h3 id="lorawan-join-phase">LoRaWAN Join Phase</h3>
<p>If the Bridge is configured to use over the air activation (OTAA), the OTAA join is performed
at this point. The device will repeatedly try to join its LoRaWAN network until the process
is successful. It then enters the Data Collection Phase.
If the Bridge is configured to use ABP instead of OTAA, this phase is left immediately and
the Data Collection Phase is entered according to the cron configuration.</p>
<h3 id="data-collection-phase">Data Collection Phase</h3>
<p>During the wMBUS collection phase the device receives any wireless M-Bus data with valid
CRC and stores it for the following LoRaWAN upload phase but only if the received telegram
passes the user defined white list filters. Similar telegrams of one identical meter may be
received multiple times during this phase. In this case the newest telegram with the same
id, type and length will replace the previously received one. Only the latest telegram will be
uploaded via LoRaWAN.
After the configured amount of time for collecting data the LoRaWAN data transfer phase
is entered.</p>
<h3 id="data-transfer-phase">Data Transfer Phase</h3>
<p>During the Data Transfer Phase the Bridge uploads all previously stored wMBUS data using
LoRaWAN. Depending on original wMBUS telegram byte sitze this can require multiple LoRaWAN
messages to be sent. Since LoRa requires any device to respect a strict duty cycle,
it is possible, that the Bridge will need to wait before sending its messages. If this happens,
the device will enter a power saving modus while waiting for the next message. It is possible
that transferring all data will take several minutes.
In addition to the wireless M-Bus data, the Bridge sends a status packet once a day during
this phase. The status packet will always be transmitted prior to any data packets.
For a detailed description of the data sent refer to chapter "Data Packet".</p>
<h3 id="sleep-phase">Sleep Phase</h3>
<p>After transferring all data packets the Bridge enters the Sleep Phase. During this it is completely
inactive to avoid wasting power. It remains sleeping until one of the cron expressions
given in the configuration triggers. When that happens, it enters the Data Collection Phase
again.</p>
<h2 id="configuration">Configuration</h2>
<h3 id="the-lobaro-maintenance-tool">The Lobaro Maintenance Tool</h3>
<p><img alt="Modbus LoRaWAN Bridge" src="files/main.png" style="width:60%; display: block; margin: 0 auto;" /></p>
<p>The initial device configuration can be done very comfortably from your PC via the serial
configuration interface. Beside the needed Lobaro USB to UART adapter the <a href="../../tools/lobaro-tool.html" target="_blank"><strong>Lobaro Maintenance Tool</strong></a> needs to be installed. This tool is freely available for various operating systems
including Windows, Linux, Mac and Linux-ARM (e.g. Raspberry-PI) on and works with all
Lobaro sensors.
Technically this software opens a webserver on port 8585 that runs in a background console
window. The actual user interface can be accessed normally using a standard web browser
at address <a href="http://localhost:8585">http://localhost:8585</a> (picture above). Normally your default browser should be
opened with this URL automatically after tool startup . Even remote configuration and logobservation
over the Internet is possible, e.g. having a Raspberry PI via USB connected to
the Lobaro device and accessing the maintenance tool from a remote machines browser over
the Internet.
Additionally to the device setup the tool can also be used for firmware updates ('Firmware
Tab') , watching real-time device diagnostic output ('Logs Tab') and initiating device restarts.</p>
<div class="admonition info">
<p class="admonition-title">Please note that the device is automatically restarted each time the configuration has been changed!</p>
</div>
<h3 id="connecting-the-usb-config-adapter">Connecting the USB config adapter</h3>
<p>For configuration and firmware updates we provide a special serial-USB adapter that can be
connected as shown in the picture below. The corresponding connector on the PCB is marked with
the word 'Config'.
The USB-adapter will add a virtual serial 'COM' Port to your system. Your operating system
needs the <a href="https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers" target="_blank">CP210x USB to UART Bridge</a> driver installed. A download link is provided next
to the 'Connect' button when you start the Maintenance Tool.
While the config adapter is connected, the device will be powered from the USB port with
a regulated voltage of 3.3V. It is not necessary - although it would be no problem - having
batteries inserted or a different supply connected while using the config adapter. All
configuration parameters will be kept non-volatile regardless of the power supply.</p>
<p><img alt="Modbus LoRaWAN Bridge" src="files/config.png" style="width:60%; display: block; margin: 0 auto;" /></p>
<h3 id="system-parameters">System parameters</h3>
<p>After being successfully connected to the hardware using the Lobaro Maintenance Tool you
can press 'Reload Config' in the 'Configuration' tab to read the current configuration from the
device. For every parameter a default value is stored non volatile inside the hardware to which
you can revert using the 'Restore default' button in case anything got miss configured.
All LoRaWAN &amp; other firmware parameters are explained in the following.</p>
<h4 id="lorawan-network-parameters">LoRaWAN network parameters</h4>
<p>A large part of the configuration parameters are used to control the device's usage of LoRaWAN.
There are two different ways to use LoRaWAN: over-the-air
activation (OTAA) and activation by personalization (ABP). Some configuration parameters
are only used with one of those methods, others are used for both.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Used</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OTAA</td>
<td>bool</td>
<td>both</td>
<td>true: use over-the-air activation (OTAA) <br> false: use activation by personalization (ABP)</td>
</tr>
<tr>
<td>DevEUI</td>
<td>bytes[8]</td>
<td>OTAA</td>
<td>the 8 byte long DevEUI is used with OTAA to identify the device on join. The default is predefined in the hardware and guarantees an ID that is unique world wide. Should not be changed unless required by the network provider. Hex format without 0x prefix.</td>
</tr>
<tr>
<td>AppEUI</td>
<td>bytes[8]</td>
<td>OTAA</td>
<td>ID defining the application used in the LoRaWAN network. Hex format without 0x prefix.</td>
</tr>
<tr>
<td>AppKey</td>
<td>bytes[16]</td>
<td>OTAA</td>
<td>Application Key as defined by the LoRaWAN network operator. This is used to encrypt communication, so keep it secret. Hex format without 0x prefix.</td>
</tr>
<tr>
<td>OTAADelay</td>
<td>int</td>
<td>OTAA</td>
<td>Seconds to wait for a new attempt after an unsuccessful OTAA join. The actual waiting time will be randomly increased by up to a third of that amount, in order to avoid devices repeatedly interfering with each other through bad timing. The default value is 300, which means the timeout between attempts is 300-400 seconds.</td>
</tr>
<tr>
<td>AppSKey</td>
<td>bytes[16]</td>
<td>ABP</td>
<td>App Session Key as defined by the LoRaWAN network operator. Hex format without 0x prefix.</td>
</tr>
<tr>
<td>NetSKey</td>
<td>bytes[16]</td>
<td>ABP</td>
<td>Network Session Key ad defined by the LoRaWAN network operator. Hex format without 0x prefix.</td>
</tr>
<tr>
<td>DevAdr</td>
<td>bytes[4]</td>
<td>ABP</td>
<td>Device Address as defined by the LoRaWAN network operator. Hex format without 0x prefix.</td>
</tr>
<tr>
<td>SF</td>
<td>int</td>
<td>both</td>
<td>Initial LoRa spreading factor used for transmissions. Valid range is 7-12. The actual spreading factor used might change during operation of the device if Adaptive Data Rate (ADR) is used.</td>
</tr>
<tr>
<td>TxPower</td>
<td>int</td>
<td>both</td>
<td>Initial transmission output power in dBm. The LoRaWAN protocol allows only specific values: 2, 5, 8, 11, 14. The actual power used might change during operation if Adaptive Data Rate (ADR) is used.</td>
</tr>
<tr>
<td>ADR</td>
<td>bool</td>
<td>both</td>
<td>true: use adaptive data rate (ADR) <br> false: don't use adaptive data rate (ADR)</td>
</tr>
</tbody>
</table>
<h4 id="wmbus-bridge-parameters">wMBUS bridge parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>loraMaxMsgSize</td>
<td>int</td>
<td>Received wireless M-Bus telegrams might have a byte size bigger than a single LoRaWAN message can hold. This parameter defines the bytes per LoRaWAN message before a partition over multiple LoRaWAN Uplink msg appears. (Range 10-50 bytes)</td>
</tr>
<tr>
<td>resetHours</td>
<td>int</td>
<td>Hours after which the firmware will reset and rejoin the network. Can support the change of LoRaWAN network providers with already deployed devices. (0 = never)</td>
</tr>
<tr>
<td>cmodeCron</td>
<td>string</td>
<td>Cron Expression defining when the device starts wMBUS T1/C1 mode receive phases. Please refer to chapter "Cron expression" for an introduction. (blank = no T1/C1 receive)</td>
</tr>
<tr>
<td>cmodeDurSec</td>
<td>int</td>
<td>Duration in seconds for each C1/T1-mode wMBUS receive phase, if cmodeCron != blank. Should be chosen in relation the wMBUS sendout interval of the target meter.</td>
</tr>
<tr>
<td>smodeCron</td>
<td>string</td>
<td>Cron Expression defining when the device starts wMBUS S1 mode receive phases. Please refer to chapter "Cron expression" for an introduction. (blank = no S1 receive)</td>
</tr>
<tr>
<td>smodeDurSec</td>
<td>int</td>
<td>Duration in seconds for each S1-mode wMBUS receive phase, if smodeCron != blank. Should be chosen in relation the wMBUS sendout interval of the target meter.</td>
</tr>
<tr>
<td>devFilter</td>
<td>string</td>
<td>wMBUS device id white-list filter using 8 digits with leading zeros list separated by ','. Example '88009035,06198833'. (blank = filter inactive)</td>
</tr>
<tr>
<td>mFilter</td>
<td>string</td>
<td>wMBUS manufacturer white-list filter separated by ',' . Example: 'DME,QDS' for receiving just telegrams from Diehl Metering GmbH and Qundis GmbH meters. Telegrams with different 3 character wMBUS manufacturer id will not be uploaded via LoRaWAN. (blank = filter inactive)</td>
</tr>
<tr>
<td>typFilter</td>
<td>string</td>
<td>wMBUS device type white-list filter list separated by ','. Example: '08,07' for Heat-Cost and Water meters. Please refer to appendix B.1 for a list of possible values. (blank = filter inactive)</td>
</tr>
</tbody>
</table>
<h4 id="cron-expressions">Cron expressions</h4>
<p>Cron expressions are used to define specific points in time and regular repetitions of them.
The schedule for data collecting phases is defined using the <a href="../../background/cron-expressions.html" target="_blank"><strong>CRON</strong></a> format which is very
powerful format to define repeatedly occurring events.</p>
<div class="admonition info">
<p class="admonition-title">Standard Lobaro devices typically do not need to know the real time for proper operation. All times are relative to the random time when batteries are inserted.</p>
</div>
<p>If needed by the target application Lobaro can deliver on request special hardware support for keeping
data acquisition intervals based on a real time clock which stays in sync with the real time.
Please contact Lobaro directly if you need such a custom product variant.
A cron expression consists of 6 values separated by spaces:</p>
<ul>
<li>
<p>Seconds (0-59)</p>
</li>
<li>
<p>Minutes (0-59)</p>
</li>
<li>
<p>Hours (0-23)</p>
</li>
<li>
<p>Days (1-31)</p>
</li>
<li>
<p>Month (1-12)</p>
</li>
<li>
<p>Day of Week (SUN-SAT b= [0,6])</p>
</li>
</ul>
<p>Examples of CRON definitions:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>0 5 * * * *</td>
<td>Hourly at minute 5, second 0 (at 00:05:00, 01:05:00, ...)</td>
</tr>
<tr>
<td>0 1/10 * * * *</td>
<td>every 10 minutes from minute 1, second 0 (minutes 1, 11, 21, ...)</td>
</tr>
<tr>
<td>0 0 6 * * *</td>
<td>Daily at 6:00:00</td>
</tr>
<tr>
<td>0 0 13 1,15 * *</td>
<td>1<sup>st</sup> and 15<sup>th</sup> day of every month at 13:00:00</td>
</tr>
<tr>
<td>0 0 9 1-5 * *</td>
<td>Every month daily from day 1 till 5 at 9:00:00</td>
</tr>
</tbody>
</table>
<h2 id="lorawan-data-upload-formats">LoRaWAN Data Upload Formats</h2>
<p>After collecting wireless M-Bus telegrams over the air, the Bridge starts uploading data
via LoRaWAN. There exist two data formats that are transmitted over different LoRaWAN
ports.
As LoRaWAN can only transmit very short messages, the message formats contain only data
bytes. The meaning of a byte is determined by its position within a message. The following
describes the package formats used by the wireless M-Bus Bridge.</p>
<h3 id="status-packet">Status Packet</h3>
<p>Port 1 - In order to provide some information about the health &amp; connectivity state of the
device itself, the device sends a status update at a daily basis. The status packet is sent
on the first upload phase after activation of the device (after reboot) and then repeatedly in
every upload phase that takes place a day or longer after the previous status packet. It has
a fixed length of 7 bytes. The battery voltages and ambient temperature are encodes as 16
bit integer using little endian encoding.</p>
<table>
<thead>
<tr>
<th>name</th>
<th>type</th>
<th>bytes</th>
<th>description</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td>uint8[3]</td>
<td>0-2</td>
<td>Version of the firmware running on the device</td>
<td>1, 5, 1 ≡ v1.5.1</td>
</tr>
<tr>
<td>v_bat</td>
<td>uint16</td>
<td>3-4</td>
<td>Battery voltage in mV</td>
<td>2947 ≡ 2:947V</td>
</tr>
<tr>
<td>temp</td>
<td>int16</td>
<td>5-6</td>
<td>Temperature measured inside the device in 1/10 °C</td>
<td>246 ≡ 24.6°C</td>
</tr>
</tbody>
</table>
<p>We provide a JavaScript reference implementation of a decoder for this status packet on
<a href="https://github.com/lobaro/ttn-data-formats/blob/master/wmbus-bridge/decoder.js" target="_blank"><strong>GitHub</strong></a>, which can be used directly for decoding in <a href="https://www.thethingsnetwork.org/" target="_blank"><strong>The Things Network</strong></a>.</p>
<h3 id="data-packet">Data Packet</h3>
<p>After each wMBUS collecting phase, all saved telegrams (up to 500 can be stored) will be
uploaded via LoRaWAN uplink messages as fast as possible. The received wMBUS telegrams
that did pass the configured white list filters will be uploaded without any modification in one
or more LoRaWAN messages.
If a wMBUS telegram is bigger than the bridge configuration parameter loraMaxMsgSize the
transmission will be done using multiple LoRaWAN messages. This parameter is limited to ≤
50 bytes due to LoRaWANs maximum payload size restrictions. In case of telegram splitting
is needed the receiving backend application server as to reassemble the original wMBUS
telegram before decryption &amp; parsing of the meter data. This is done by simply joining the
messages together in the order of receive.
The LoRaWAN port encodes identifies a LoRaWAN fragment of the original wireless M-Bus
telegram. This way partial messages can be identified using the LoRaWAN Port:</p>
<ul>
<li>10 &lt; LoRaWAN Port &lt; 100 ≡ (Part Number | Total Parts)</li>
</ul>
<p>Gaps in the LoRaWAN Frame Counter are giving a hint for missing telegram parts which can
happen in LoRaWAN since it's a ALOHA based protocol, e.g. collisions and some packet
losses are accepted by principle of operation. In case the backend noticed a missing packet
the wMBUS telegram can't be assembled anymore as described before.</p>
<h4 id="examples">Examples</h4>
<p>Examples (with loraMaxMsgSize = 50):</p>
<ul>
<li>A 48 Byte wMBUS telegram will be send on LoRaWAN port 11. Port 11 says it is the first message of only one message (no splitting).</li>
<li>A 75 byte wMBUS telegram will be send in two messages on LoRaWAN ports 12 and 22. Port 12 means this part one of a wMBUS telegram that got splitted into two LoRaWAN messages. Port 22 means that this data is the 2<sup>nd</sup> part of the original wMBUS data. Both parts have to been concatenated in the order of receive by the backend.</li>
<li>A 101 byte wMBUS telegram will be send in three messages on LoRaWAN ports 13, 23 and 33. Port 13 means this part one of a wMBUS telegram that got splitted into three LoRaWAN messages. Port 23 means that this data is the 2<sup>nd</sup> part of the original wMBUS data. Port 33 means that this data is the 3<sup>rd</sup> part of the original wMBUS data. All three parts have to been concatenated in the order of receive by the backend.</li>
</ul>
<h4 id="upload-rate">Upload Rate</h4>
<p>The bridge has to work in compliance with the European SRD 868 1% duty-cycle regulations.
This implies as a rule of thumb the device can upload at most wMBUS telegrams for 36
seconds every hour. The actual transmit time ('ToA: time on air') for each LoRaWAN
message depends on the byte size and the used LoRa spreading factor (SF) which denes how
redundant LoRa data is send. This means a device with good connectivity and consequently
using LoRa SF7 (ToA ≤ 0,050s) can upload much faster more data than a node using LoRa
SF11 (ToA ≥ 1s) due to a hard to reach LoRaWAN gateway. The bridge will upload in
conformity with the regulations automatically as fast as possible. When it has to wait it
enters a low power sleep mode until the next transmission is possible again.
The next data collection phase will be started only after completion of the previous upload
phase in respect to the configured cmodeCron or smodeCron, whichever is earlier. Because
of this it is advisable to define the cron parameters with an estimation of the upload duration
in mind. This will avoid unexpected 'skipping' of data collection phases.
If you find that the data rate LoRaWAN offers is a limitation for your setup, we could also
provide you with a wireless M-Bus solution that uses alternate data transmission technologies,
for example GSM/LTE or NarrowBand-IoT.
Find our contact information under <a href="https://www.lobaro.com/contact/">https://www.lobaro.com/contact/</a>, or simple send us
an email to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;">&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;</a> - either English or German is fine.</p>
<h4 id="decoding-wireless-m-bus">Decoding wireless M-Bus</h4>
<p>After receiving the raw wireless M-Bus telegrams from your LoRaWAN network provider
the actual metering data has to be decrypted and decoded by a backend service for further
processing. The details of this are described in the EN 13757 norm and the newer <a href="https://oms-group.org/en/download4all/oms-specification/" target="_blank"><strong>OMS</strong></a>
specification, which is a clarification of the original underlying norm.
A universal wireless M-Bus decoder is a relatively complicated piece of software if you start
implementing it from scratch since the norm covers many different use cases, units, meter
types and data formats. If you know in advance the exact telegram format of the deployed
meters in your setup a hard coded data decoding may be a feasible approach. This is because
wireless M-Bus devices often send the same telegram format in every transmission. Please
contact the manufacturer of your meters for the needed telegram format details.</p>
<p><img alt="Modbus LoRaWAN Bridge" src="files/decoder.png" style="width:60%; display: block; margin: 0 auto;" /></p>
<p>An an alternative to support a quick evaluation of our hardware Lobaro offers a easy to use
webservice which is designed to decode all sorts of wMBUS input data including decryption
if the correct key has been provided (see picture above). This REST API returns a JSON object including all encapsulated fields, e.g. the actual metering values. This greatly simplifies the
bridge integration into your web based service or application.
A 12 months period of free access to this API is included in our 'wmbus bridge testpacket'
offer for quick device evaluation. API Integration into production systems is also possible,
but in this case a separate agreement about a royalty fee must be achieved up front. For
more information on licensing our wireless M-Bus parsing API plase send us your request via
email to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;">&#105;&#110;&#102;&#111;&#64;&#108;&#111;&#98;&#97;&#114;&#111;&#46;&#99;&#111;&#109;</a> - either English or German is fine.</p>
<h2 id="technical-characteristics">Technical characteristics</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Product</strong></td>
<td></td>
</tr>
<tr>
<td>Type name</td>
<td>wMBUS-LoRaWAN</td>
</tr>
<tr>
<td>Description</td>
<td>wMBUS over LoRaWAN Bridge</td>
</tr>
<tr>
<td><strong>RF transceiver</strong></td>
<td></td>
</tr>
<tr>
<td>Chipset</td>
<td>Semtech SX1272</td>
</tr>
<tr>
<td>Frequency Range</td>
<td>863 to 870 MHz</td>
</tr>
<tr>
<td>TX Power</td>
<td>≤ 14 dBm</td>
</tr>
<tr>
<td><strong>LoRa communication</strong></td>
<td></td>
</tr>
<tr>
<td>LoRaWAN Protocol</td>
<td>Class A / Class C LoRaWAN 1.1 EU868</td>
</tr>
<tr>
<td>Activation method</td>
<td>Over-the-air activation (OTAA) <br> Activation by personalization (ABP)</td>
</tr>
<tr>
<td>Encryption</td>
<td>AES128</td>
</tr>
<tr>
<td>Typically RF range</td>
<td>≤ 2km</td>
</tr>
<tr>
<td>Ideal RF range</td>
<td>≤ 10km (free line of sight)</td>
</tr>
<tr>
<td><strong>Wireless M-BUS communication</strong></td>
<td></td>
</tr>
<tr>
<td>Supported Modes (EN13757-4)</td>
<td>S1, C1, T1</td>
</tr>
<tr>
<td>Frequencies</td>
<td>868.3 MHz, 868.95 MHz</td>
</tr>
<tr>
<td>RF Range</td>
<td>≤ 30m</td>
</tr>
<tr>
<td>Telegram memory</td>
<td>up to 500 telegrams (on request: 1.500)</td>
</tr>
<tr>
<td><strong>Power Supply</strong></td>
<td></td>
</tr>
<tr>
<td>Nominal Supply Voltage</td>
<td>3V</td>
</tr>
<tr>
<td>Supply Voltage Range</td>
<td>2.2V - 3.7V</td>
</tr>
<tr>
<td>Power supply</td>
<td>2xAA battery, 1.5V (LR6/FR6) <br> 5V USB powered over Lobaro Adapter <br> On Request: 230V mains adapter, 3.6V Battery</td>
</tr>
<tr>
<td><strong>Current consumption @3V</strong></td>
<td></td>
</tr>
<tr>
<td>Normal</td>
<td>≤3 mA</td>
</tr>
<tr>
<td>Wireless M-BUS RX</td>
<td>≤14 mA</td>
</tr>
<tr>
<td>LoRa RX</td>
<td>≤14 mA</td>
</tr>
<tr>
<td>LoRa TX</td>
<td>≤80 mA</td>
</tr>
<tr>
<td>Sleep with RTC running</td>
<td>≤20 µA</td>
</tr>
<tr>
<td><strong>Mechanical dimensions</strong></td>
<td></td>
</tr>
<tr>
<td>Size</td>
<td>114.3 mm x 59.3 mm x 26.8 mm</td>
</tr>
<tr>
<td>Housing Material</td>
<td>ABS plastic</td>
</tr>
<tr>
<td><strong>Environmental Requirements</strong></td>
<td></td>
</tr>
<tr>
<td>Operating temperature range</td>
<td>-20°C to +55°C</td>
</tr>
<tr>
<td>Max. Installation height</td>
<td>2m</td>
</tr>
<tr>
<td><strong>Conformity</strong></td>
<td></td>
</tr>
<tr>
<td><img title="CE" alt="CE logo" src="/img/symbol-ce.svg" height="60"> <img title="weee" title="weee logo" src="/img/symbol-weee.svg" height="60"></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="housing-dimensions">Housing Dimensions</h3>
<p><img alt="Modbus LoRaWAN Bridge" src="files/housing.png" style="width:80%; display: block; margin: 0 auto;" /></p>
<h2 id="target-measurement-purpose">Target Measurement / Purpose</h2>
<p>Forwarding of wireless M-BUS messages via LoRaWAN.</p>
<p><strong>Features</strong></p>
<ul>
<li>wMBUS C1/T1 and S1 modes</li>
<li>868 MHz only (433 MHz on request)</li>
</ul>
<h2 id="pdf-documentation">PDF Documentation</h2>
<ul>
<li><a href="files/lorawan-wmbus-bridge_en.pdf" target="_blank">PDF Manual (en) for firmware V1.5.1</a></li>
<li><a href="files/W-MBus Lora Bridge Flyer.pdf" target="_blank">Product Flyer</a></li>
<li><a href="files/scan-ce-conformity-wmbus-lorawan.pdf" target="_blank">Declaration of Conformity</a></li>
</ul>
<h2 id="parser">Parser</h2>
<h3 id="ttn">TTN</h3>
<div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">readVersion</span><span class="p">(</span><span class="nx">bytes</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">bytes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="s2">&quot;v&quot;</span> <span class="o">+</span> <span class="nx">bytes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">bytes</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">bytes</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Decoder</span><span class="p">(</span><span class="nx">bytes</span><span class="p">,</span> <span class="nx">port</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Decode an uplink message from a buffer</span>
    <span class="c1">// (array) of bytes to an object of fields.</span>
    <span class="kd">var</span> <span class="nx">decoded</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">port</span> <span class="o">===</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">devStatus</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">devID</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">;</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">dif</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">vif</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">data0</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">data1</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">data2</span> <span class="o">=</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="c1">// example decoder for status packet by lobaro</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">port</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// status packet</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">FirmwareVersion</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span> <span class="c1">// byte 0-4</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">Vbat</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bytes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">;</span> <span class="c1">// byte 6-7 (originally in mV)</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">Temp</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bytes</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">;</span> <span class="c1">// byte 8-9 (originally in 10th degree C)</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="s2">&quot;Firmware Version: v&quot;</span> <span class="o">+</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">FirmwareVersion</span> <span class="o">+</span> <span class="s2">&quot; Battery: &quot;</span> <span class="o">+</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">Vbat</span> <span class="o">+</span> <span class="s2">&quot;V Temperature: &quot;</span> <span class="o">+</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">Temp</span> <span class="o">+</span> <span class="s2">&quot;°C&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">port</span> <span class="o">===</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">FirmwareVersion</span> <span class="o">=</span> <span class="nx">readVersion</span><span class="p">(</span><span class="nx">bytes</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// byte 0-2</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">Vbat</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bytes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">;</span> <span class="c1">// originally in mV</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">Temp</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bytes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">|</span> <span class="nx">bytes</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">;</span> <span class="c1">// originally in 10th degree C</span>
        <span class="nx">decoded</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="s2">&quot;Firmware Version: &quot;</span> <span class="o">+</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">FirmwareVersion</span> <span class="o">+</span> <span class="s2">&quot; Battery: &quot;</span> <span class="o">+</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">Vbat</span> <span class="o">+</span> <span class="s2">&quot;V Temperature: &quot;</span> <span class="o">+</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">Temp</span> <span class="o">+</span> <span class="s2">&quot;°C&quot;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">decoded</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<div class="footnote">
<hr />
<ol>
<li id="fn: 1">
<p>Energy Meter, Water Meter and House Icons made by Freepik from <a href="http://www.flaticon.com">www.flaticon.com</a> is licensed by CC 3.0 BY
Heater Icon made by Nikita Golubev from <a href="http://www.flaticon.com">www.flaticon.com</a> is licensed by CC 3.0 BY
Map Icon Icons made by Darius Dan from <a href="http://www.flaticon.com">www.flaticon.com</a> is licensed by CC 3.0 BY
LoRaWAN Logo © LoRa Alliance, NB-IoT Logo © GSM Association, wM-Bus Logo © <a href="http://www.m-bus.com">www.m-bus.com</a>&#160;<a class="footnote-backref" href="#fnref: 1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../hardware.html" title="Hardware Variations" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Hardware Variations
              </span>
            </div>
          </a>
        
        
          <a href="firmware.html" title="Firmware & Changelog" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Firmware & Changelog
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Lobaro GmbH
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a8b5e56f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/mermaid.min.js"></script>
      
    
  </body>
</html>